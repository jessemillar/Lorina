<html>
	<head>
		<title>Lorina</title>
		<style>
			html, body
			{
				padding: 0px;
				margin: 0px;
			}

			#canvas
			{
				position: absolute;
				left: 50%;
				top: 50%;
				margin-left: -200px;
				margin-top: -200px;
				z-index: 0;
			}
		</style>
		<script src = "../lorina.js"></script>
		<script src = "../lorina-audio.js"></script>
		<script src = "../lorina-collisions.js"></script>
		<script src = "../lorina-draw.js"></script>
		<script src = "../lorina-mouse.js"></script>
		<script src = "../lorina-objects.js"></script>
		<script src = "../lorina-preloader.js"></script>
		<script src = "../lorina-text.js"></script>
		<script src = "../lorina-touches.js"></script>
	</head>
	<body onkeydown = 'key(event)'>
		<canvas id = "canvas" width = "400px" height = "400px"></canvas>
	</body>
	<script>
		var corgiSpeed = 75

		l.game.setup('#111111')
		// l.touches.enable()
		l.mouse.enable()
		l.debug.all = false
			l.debug.mouse = false
			l.debug.anchor = false
			l.debug.bounding = true
			l.debug.names = false
			l.debug.position = true

		l.audio.make('music', 'sounds/music.wav')

		l.object.make('marker', 300, 100)
		l.object.make('corgi1', 0, 0, 'images/corgi.png', 35, 35)
			l.object.anchor('corgi1', 35, 35)
			l.object.bounding('corgi1', 8, 8, 5, 5)
		l.object.make('corgi2', 120, 120, 'images/corgi.png', 35, 35)

		l.game.start() // Start the game which fires the preloader which then "starts" the game via a variable change after all images are loaded

		function game()
		{
			if (l.game.state == 'loading')
			{
				l.draw.blank()
				l.text.write(l.preloader.percent + '% loaded', 10, l.camera.height - 10, '#ffffff')
			}
			else if (l.game.state == 'running')
			{
				if (l.mouse.x && l.mouse.y)
				{
					l.move.snap('marker', l.mouse.x, l.mouse.y)
				}

				// l.audio.loop('music')

				l.move.toward('corgi1', 'marker', corgiSpeed) // Track the marker
				l.move.toward('corgi2', 'corgi1', corgiSpeed / 2) // Chase the other corgi

				if (l.collision.overlap('corgi1', 'corgi2'))
				{
					l.camera.color = '#ff0000'
				}
				else
				{
					l.camera.color = '#111111'
				}

				l.draw.blank()
				l.draw.object('corgi1')
				l.draw.object('corgi2')
			}
		}

		function key(event)
		{
			if (event.keyCode == 32) // Spacebar
			{
				l.move.snap('marker', l.camera.width, l.camera.height)
			}

			if (event.keyCode == 38) // Up arrow
			{
				l.move.up('corgi1', corgiSpeed)
			}
			else if (event.keyCode == 40) // Down arrow
			{
				l.move.down('corgi1', corgiSpeed)
			}

			if (event.keyCode == 37) // Left arrow
			{
				l.move.left('corgi1', corgiSpeed)
			}
			else if (event.keyCode == 39) // Right arrow
			{
				l.move.right('corgi1', corgiSpeed)
			}
		}
	</script>
</html>